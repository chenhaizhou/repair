(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["detail"],{"1d82":function(t,e,a){},ae39:function(t,e,a){},b8fa:function(t,e,a){},bff0:function(t,e,a){},c194:function(t,e,a){"use strict";a("68ef"),a("9d70"),a("3743"),a("1a04")},c84b:function(t,e,a){"use strict";a.r(e);var n,i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"preview"},[a("NavBar",{attrs:{back:"",title:t.data.id}}),a("van-collapse",{model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("div",{staticClass:"step"},[a("van-collapse-item",{attrs:{name:"1"},scopedSlots:t._u([{key:"title",fn:function(){return[a("Title",{style:{margin:0,padding:0,border:0},attrs:{title:"跟踪"}})]},proxy:!0}])},[a("van-steps",{attrs:{direction:"vertical","inactive-icon":"checked","active-icon":t.stepIcon,active:0,"active-color":"#38f"}},t._l(t.historyList,(function(e,n){return a("van-step",{key:n},[a("h3",[t._v(t._s(e.activityName))]),a("p",[t._v(t._s(e.comment))]),e.assigneeName?a("p",[a("van-icon",{attrs:{name:"user-o"}}),a("span",[t._v(t._s(e.assigneeName))])],1):t._e(),e.durationTime?a("p",[a("van-icon",{attrs:{name:"clock-o"}}),a("span",[t._v(t._s(e.durationTime))])],1):t._e()])})),1)],1)],1)]),a("div",{staticClass:"detail"},[a("van-cell-group",[a("Title",{attrs:{title:"详情"}}),a("van-cell",{attrs:{title:"报修人",value:t.data.user.name}}),a("van-cell",{attrs:{title:"学工号",value:t.data.user.loginName}}),a("van-cell",{attrs:{title:"所属部门",value:t.data.user.depart.text}}),a("van-cell",{attrs:{title:"联系方式",value:t.data.user.phone}}),a("van-cell",{attrs:{title:"所属校区",value:t.data.department.school.text}}),a("van-cell",{attrs:{title:"报修分类",value:t.data.department.area.text}}),a("van-cell",{attrs:{title:"工单标题",value:t.data.title}}),a("van-cell",{attrs:{title:"报修内容"}},[t._v("\n        "+t._s(t.data.content)+"\n      ")]),a("van-cell",{attrs:{title:"报修地点",value:t.data.location}}),a("van-cell",{attrs:{title:"附件"}},[[a("div",{staticClass:"imgs"},[a("van-uploader",{attrs:{multiple:"",deletable:!1,"show-upload":!1},model:{value:t.data.issue,callback:function(e){t.$set(t.data,"issue",e)},expression:"data.issue"}})],1)]],2)],1),a("van-cell-group",[t.data.assignClass.className?a("van-cell",{attrs:{title:"分配班组",value:t.data.assignClass.className}}):t._e(),t.data.assignClass.leader?a("van-cell",{attrs:{title:"班组长",value:t.data.assignClass.leader}}):t._e(),t.data.worker.name?a("van-cell",{attrs:{title:"维修员",value:t.data.worker.name}}):t._e(),t.data.worker.phone?a("van-cell",{attrs:{title:"联系方式",value:t.data.worker.phone}}):t._e(),t.showWorkAttachment?a("van-cell",{attrs:{title:"维修附件"}},[[a("div",{staticClass:"imgs"},[a("van-uploader",{attrs:{multiple:"",deletable:!1,"show-upload":!1},model:{value:t.data.worker.attachment,callback:function(e){t.$set(t.data.worker,"attachment",e)},expression:"data.worker.attachment"}})],1)]],2):t._e()],1),t.rate.grade?a("van-cell-group",[a("van-cell",{attrs:{title:"评价"}},[[a("van-rate",{attrs:{count:"3",readonly:"",size:25,color:"#3ca2e0","void-icon":"star","void-color":"#eee"},model:{value:t.rate.grade,callback:function(e){t.$set(t.rate,"grade",e)},expression:"rate.grade"}})]],2),a("van-cell",{attrs:{title:"评价说明",value:t.rate.content}})],1):t._e()],1)],1)},s=[],r=a("bd86"),c=(a("4142"),a("39d1")),o=(a("e930"),a("8f80")),l=(a("68ef"),a("9d70"),a("3743"),a("1a04"),a("bff0"),a("c31d")),d=a("d282"),u=a("a142"),h=a("4598"),v=a("9884"),p=a("7744"),f=a("dfaf"),m=Object(d["a"])("collapse-item"),b=m[0],g=m[1],k=["title","icon","right-icon"],w=b({mixins:[Object(v["a"])("vanCollapse")],props:Object(l["a"])(Object(l["a"])({},f["a"]),{},{name:[Number,String],disabled:Boolean,isLink:{type:Boolean,default:!0}}),data:function(){return{show:null,inited:null}},computed:{currentName:function(){return Object(u["b"])(this.name)?this.name:this.index},expanded:function(){var t=this;if(!this.parent)return null;var e=this.parent,a=e.value,n=e.accordion;return n?a===this.currentName:a.some((function(e){return e===t.currentName}))}},created:function(){this.show=this.expanded,this.inited=this.expanded},watch:{expanded:function(t,e){var a=this;if(null!==e){t&&(this.show=!0,this.inited=!0);var n=t?this.$nextTick:h["c"];n((function(){var e=a.$refs,n=e.content,i=e.wrapper;if(n&&i){var s=n.offsetHeight;if(s){var r=s+"px";i.style.height=t?0:r,Object(h["b"])((function(){i.style.height=t?r:0}))}else a.onTransitionEnd()}}))}}},methods:{onClick:function(){if(!this.disabled){var t=this.parent,e=this.currentName,a=t.accordion&&e===t.value,n=a?"":e;t.switch(n,!this.expanded)}},onTransitionEnd:function(){this.expanded?this.$refs.wrapper.style.height="":this.show=!1},genTitle:function(){var t=this,e=this.$createElement,a=this.border,n=this.disabled,i=this.expanded,s=k.reduce((function(e,a){return t.slots(a)&&(e[a]=function(){return t.slots(a)}),e}),{});return this.slots("value")&&(s.default=function(){return t.slots("value")}),e(p["a"],{attrs:{role:"button",tabindex:n?-1:0,"aria-expanded":String(i)},class:g("title",{disabled:n,expanded:i,borderless:!a}),on:{click:this.onClick},scopedSlots:s,props:Object(l["a"])({},this.$props)})},genContent:function(){var t=this.$createElement;if(this.inited)return t("div",{directives:[{name:"show",value:this.show}],ref:"wrapper",class:g("wrapper"),on:{transitionend:this.onTransitionEnd}},[t("div",{ref:"content",class:g("content")},[this.slots()])])}},render:function(){var t=arguments[0];return t("div",{class:[g({border:this.index&&this.border})]},[this.genTitle(),this.genContent()])}}),y=a("b1d2"),x=Object(d["a"])("collapse"),O=x[0],S=x[1],j=O({mixins:[Object(v["b"])("vanCollapse")],props:{accordion:Boolean,value:[String,Number,Array],border:{type:Boolean,default:!0}},methods:{switch:function(t,e){this.accordion||(t=e?this.value.concat(t):this.value.filter((function(e){return e!==t}))),this.$emit("change",t),this.$emit("input",t)}},render:function(){var t,e=arguments[0];return e("div",{class:[S(),(t={},t[y["c"]]=this.border,t)]},[this.slots()])}}),C=(a("c3a6"),a("ad06")),I=(a("ae39"),Object(d["a"])("step")),N=I[0],_=I[1],$=N({mixins:[Object(v["a"])("vanSteps")],computed:{status:function(){return this.index<this.parent.active?"finish":this.index===+this.parent.active?"process":void 0},active:function(){return"process"===this.status},lineStyle:function(){if("finish"===this.status&&this.parent.activeColor)return{background:this.parent.activeColor}}},methods:{genCircle:function(){var t=this.$createElement,e=this.parent,a=e.activeIcon,n=e.activeColor,i=e.inactiveIcon;if(this.active)return this.slots("active-icon")||t(C["a"],{class:_("icon","active"),attrs:{name:a,color:n}});var s=this.slots("inactive-icon");return i||s?s||t(C["a"],{class:_("icon"),attrs:{name:i}}):t("i",{class:_("circle"),style:this.lineStyle})},onClickStep:function(){this.parent.$emit("click-step",this.index)}},render:function(){var t,e=arguments[0],a=this.status,n=this.active,i=this.parent,s=i.activeColor,r=i.direction,c=n&&{color:s};return e("div",{class:[y["a"],_([r,(t={},t[a]=a,t)])]},[e("div",{class:_("title",{active:n}),style:c,on:{click:this.onClickStep}},[this.slots()]),e("div",{class:_("circle-container"),on:{click:this.onClickStep}},[this.genCircle()]),e("div",{class:_("line"),style:this.lineStyle})])}}),T=(a("1d82"),Object(d["a"])("steps")),E=T[0],B=T[1],D=E({mixins:[Object(v["b"])("vanSteps")],props:{activeColor:String,inactiveIcon:String,active:{type:[Number,String],default:0},direction:{type:String,default:"horizontal"},activeIcon:{type:String,default:"checked"}},render:function(){var t=arguments[0];return t("div",{class:B([this.direction])},[t("div",{class:B("items")},[this.slots()])])}}),L=(a("0653"),a("34e9")),J=(a("7f7f"),a("c194"),a("d000")),M=a("43b3"),A=a("5a0c"),F=a.n(A),H=a("bc3a"),R=a.n(H),z=function(t){var e=parseInt(Math.floor(t/1440)),a=e>0?Math.floor((t-1440*e)/60):Math.floor(t/60),n=a>0?Math.floor(t-1440*e-60*a):t,i="";return e>0&&(i+=e+"天"),a>0&&(i+=a+"小时"),n>0&&(i+=n+"分钟"),i},W=a("0d90"),q=a("db49"),G=localStorage.getItem("sessionId"),K={props:["procInsId"],data:function(){return{activeNames:["1"],historyList:[],data:{user:{depart:{}},worker:{attachment:[]},assignClass:{},department:{school:{},area:{}},issue:[]},stepIcon:"",rate:{}}},components:(n={},Object(r["a"])(n,p["a"].name,p["a"]),Object(r["a"])(n,L["a"].name,L["a"]),Object(r["a"])(n,D.name,D),Object(r["a"])(n,$.name,$),Object(r["a"])(n,C["a"].name,C["a"]),Object(r["a"])(n,j.name,j),Object(r["a"])(n,w.name,w),Object(r["a"])(n,o["a"].name,o["a"]),Object(r["a"])(n,c["a"].name,c["a"]),Object(r["a"])(n,"NavBar",J["a"]),Object(r["a"])(n,"Title",M["a"]),n),computed:{timeDiff:function(){return F()(this.startTime)+"-"+F()(this.endTime)},showWorkAttachment:function(){return this.data.worker.attachment.length>0}},mounted:function(){var t=this.$route.params.id;this.getHistory(t),this.getDetail(t),this.getRate(t)},filters:{timeDiff:function(t,e){return z(F()(e).diff(F()(t),"minute"))}},methods:{onBack:function(){this.show=!1,this.$router.back(-1)},setStepIcon:function(t){this.stepIcon="结束"===t.activityName?"checked":"clock"},getHistory:function(t){var e=this;R.a.get("".concat(q["a"],"/repair/a/wechat/api/task/histoicFlow"),{params:{procInsId:t}}).then((function(t){e.historyList=t.data.body.histoicFlowList.reverse().filter((function(t){return!!t.activityName})),e.setStepIcon(e.historyList[0])})).catch((function(t){console.log(t)}))},getDetail:function(t){var e=this;R.a.get("".concat(q["a"],"/repair/a/wechat/api/rprorder/getRprOrder;JSESSIONID=").concat(G),{params:{procInsId:t}}).then((function(t){e.data=Object(W["a"])(t.data.body),console.log("ddddd",e.data)})).catch((function(t){console.log(t)}))},getRate:function(t){var e=this;R.a.get("".concat(q["a"],"/repair/a/wechat/api/evaluate/getEvaluateInfo;JSESSIONID=").concat(G),{params:{procInstId:t}}).then((function(t){t.data.body.evaluate&&(e.rate={id:t.data.body.evaluate.id,flag:t.data.body.evaluate.orderFlag,grade:parseInt(t.data.body.evaluate.grade,10),content:t.data.body.evaluate.content})})).catch((function(t){console.log(t)}))}}},P=K,Q=(a("ed23"),a("2877")),U=Object(Q["a"])(P,i,s,!1,null,null,null);e["default"]=U.exports},ed23:function(t,e,a){"use strict";var n=a("b8fa"),i=a.n(n);i.a}}]);
//# sourceMappingURL=detail.eb9795a9.js.map